CREATE TABLE IF NOT EXISTS `__EFMigrationsHistory` (
    `MigrationId` varchar(150) CHARACTER SET utf8mb4 NOT NULL,
    `ProductVersion` varchar(32) CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PK___EFMigrationsHistory` PRIMARY KEY (`MigrationId`)
) CHARACTER SET=utf8mb4;

START TRANSACTION;

ALTER DATABASE CHARACTER SET utf8mb4;

CREATE TABLE `NAVIOS` (
    `ID_NAVIO` int NOT NULL AUTO_INCREMENT,
    `NOME` longtext CHARACTER SET utf8mb4 NOT NULL,
    `CAPACIDADE_PESSOAS` int NOT NULL,
    CONSTRAINT `PK_NAVIOS` PRIMARY KEY (`ID_NAVIO`)
) CHARACTER SET=utf8mb4;

CREATE TABLE `SEXO_PESSOA` (
    `ID_SEXO_PESSOA` int NOT NULL AUTO_INCREMENT,
    `SEXO` longtext CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PK_SEXO_PESSOA` PRIMARY KEY (`ID_SEXO_PESSOA`)
) CHARACTER SET=utf8mb4;

CREATE TABLE `TIPO_CABINE` (
    `ID_TIPO_CABINE` int NOT NULL AUTO_INCREMENT,
    `TIPO` longtext CHARACTER SET utf8mb4 NOT NULL,
    `DESCRICAO` longtext CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PK_TIPO_CABINE` PRIMARY KEY (`ID_TIPO_CABINE`)
) CHARACTER SET=utf8mb4;

CREATE TABLE `TIPO_TRIPULATE` (
    `ID_TIPO_TRIPULANTE` int NOT NULL AUTO_INCREMENT,
    `TIPO` longtext CHARACTER SET utf8mb4 NULL,
    CONSTRAINT `PK_TIPO_TRIPULATE` PRIMARY KEY (`ID_TIPO_TRIPULANTE`)
) CHARACTER SET=utf8mb4;

CREATE TABLE `CRUZEIROS` (
    `ID_CRUZEIRO` int NOT NULL AUTO_INCREMENT,
    `NOME_EXPEDICAO` varchar(100) CHARACTER SET utf8mb4 NOT NULL,
    `DATA_PARTIDA` datetime(6) NOT NULL,
    `DATA_CHEGADA` datetime(6) NOT NULL,
    `DESCRICAO` longtext CHARACTER SET utf8mb4 NULL,
    `ID_NAVIO` int NOT NULL,
    `PRECO` double NOT NULL,
    CONSTRAINT `PK_CRUZEIROS` PRIMARY KEY (`ID_CRUZEIRO`),
    CONSTRAINT `FK_CRUZEIROS_NAVIOS_ID_NAVIO` FOREIGN KEY (`ID_NAVIO`) REFERENCES `NAVIOS` (`ID_NAVIO`) ON DELETE CASCADE
) CHARACTER SET=utf8mb4;

CREATE TABLE `PESSOAS` (
    `ID_PESSOA` int NOT NULL AUTO_INCREMENT,
    `NOME` varchar(255) CHARACTER SET utf8mb4 NOT NULL,
    `EMAIL` longtext CHARACTER SET utf8mb4 NOT NULL,
    `IDADE` int NOT NULL,
    `ID_SEXO_PESSOA` int NOT NULL,
    `DOCUMENTO` longtext CHARACTER SET utf8mb4 NOT NULL,
    `SENHA` longtext CHARACTER SET utf8mb4 NOT NULL,
    CONSTRAINT `PK_PESSOAS` PRIMARY KEY (`ID_PESSOA`),
    CONSTRAINT `FK_PESSOAS_SEXO_PESSOA_ID_SEXO_PESSOA` FOREIGN KEY (`ID_SEXO_PESSOA`) REFERENCES `SEXO_PESSOA` (`ID_SEXO_PESSOA`) ON DELETE CASCADE
) CHARACTER SET=utf8mb4;

CREATE TABLE `CABINES` (
    `ID_CABINE` int NOT NULL AUTO_INCREMENT,
    `ID_NAVIO` int NOT NULL,
    `NUMERO` longtext CHARACTER SET utf8mb4 NOT NULL,
    `PISO` longtext CHARACTER SET utf8mb4 NOT NULL,
    `CAPACIDADE_MAXIMA` int NOT NULL,
    `ID_TIPO_CABINE` int NOT NULL,
    CONSTRAINT `PK_CABINES` PRIMARY KEY (`ID_CABINE`),
    CONSTRAINT `FK_CABINES_NAVIOS_ID_NAVIO` FOREIGN KEY (`ID_NAVIO`) REFERENCES `NAVIOS` (`ID_NAVIO`) ON DELETE CASCADE,
    CONSTRAINT `FK_CABINES_TIPO_CABINE_ID_TIPO_CABINE` FOREIGN KEY (`ID_TIPO_CABINE`) REFERENCES `TIPO_CABINE` (`ID_TIPO_CABINE`) ON DELETE CASCADE
) CHARACTER SET=utf8mb4;

CREATE TABLE `PESSOA_FAVORITOS` (
    `ID` int NOT NULL AUTO_INCREMENT,
    `ID_PESSOA` int NOT NULL,
    `ID_CRUZEIRO` int NOT NULL,
    CONSTRAINT `PK_PESSOA_FAVORITOS` PRIMARY KEY (`ID`),
    CONSTRAINT `FK_PESSOA_FAVORITOS_CRUZEIROS_ID_CRUZEIRO` FOREIGN KEY (`ID_CRUZEIRO`) REFERENCES `CRUZEIROS` (`ID_CRUZEIRO`) ON DELETE CASCADE,
    CONSTRAINT `FK_PESSOA_FAVORITOS_PESSOAS_ID_PESSOA` FOREIGN KEY (`ID_PESSOA`) REFERENCES `PESSOAS` (`ID_PESSOA`) ON DELETE CASCADE
) CHARACTER SET=utf8mb4;

CREATE TABLE `CABINE_TRIPULANTE` (
    `ID_CABINE_TRIPULANTE` int NOT NULL AUTO_INCREMENT,
    `ID_CABINE` int NOT NULL,
    `ID_TRIPULANTE` int NOT NULL,
    `ID_CRUZEIRO` int NOT NULL,
    CONSTRAINT `PK_CABINE_TRIPULANTE` PRIMARY KEY (`ID_CABINE_TRIPULANTE`),
    CONSTRAINT `FK_CABINE_TRIPULANTE_CABINES_ID_CABINE` FOREIGN KEY (`ID_CABINE`) REFERENCES `CABINES` (`ID_CABINE`) ON DELETE CASCADE,
    CONSTRAINT `FK_CABINE_TRIPULANTE_CRUZEIROS_ID_CRUZEIRO` FOREIGN KEY (`ID_CRUZEIRO`) REFERENCES `CRUZEIROS` (`ID_CRUZEIRO`) ON DELETE CASCADE
) CHARACTER SET=utf8mb4;

CREATE TABLE `TRIPULANTES` (
    `ID_TRIPULANTE` int NOT NULL AUTO_INCREMENT,
    `ID_PESSOA` int NOT NULL,
    `ID_TIPO_TRIPULANTE` int NOT NULL,
    `ID_CRUZEIRO` int NOT NULL,
    `ID_CABINE_TRIPULANTE` int NULL,
    CONSTRAINT `PK_TRIPULANTES` PRIMARY KEY (`ID_TRIPULANTE`),
    CONSTRAINT `FK_TRIPULANTES_CABINE_TRIPULANTE_ID_CABINE_TRIPULANTE` FOREIGN KEY (`ID_CABINE_TRIPULANTE`) REFERENCES `CABINE_TRIPULANTE` (`ID_CABINE_TRIPULANTE`),
    CONSTRAINT `FK_TRIPULANTES_CRUZEIROS_ID_CRUZEIRO` FOREIGN KEY (`ID_CRUZEIRO`) REFERENCES `CRUZEIROS` (`ID_CRUZEIRO`) ON DELETE CASCADE,
    CONSTRAINT `FK_TRIPULANTES_PESSOAS_ID_PESSOA` FOREIGN KEY (`ID_PESSOA`) REFERENCES `PESSOAS` (`ID_PESSOA`) ON DELETE CASCADE,
    CONSTRAINT `FK_TRIPULANTES_TIPO_TRIPULATE_ID_TIPO_TRIPULANTE` FOREIGN KEY (`ID_TIPO_TRIPULANTE`) REFERENCES `TIPO_TRIPULATE` (`ID_TIPO_TRIPULANTE`) ON DELETE CASCADE
) CHARACTER SET=utf8mb4;

CREATE INDEX `IX_CABINE_TRIPULANTE_ID_CABINE` ON `CABINE_TRIPULANTE` (`ID_CABINE`);

CREATE INDEX `IX_CABINE_TRIPULANTE_ID_CRUZEIRO` ON `CABINE_TRIPULANTE` (`ID_CRUZEIRO`);

CREATE INDEX `IX_CABINE_TRIPULANTE_ID_TRIPULANTE` ON `CABINE_TRIPULANTE` (`ID_TRIPULANTE`);

CREATE INDEX `IX_CABINES_ID_NAVIO` ON `CABINES` (`ID_NAVIO`);

CREATE INDEX `IX_CABINES_ID_TIPO_CABINE` ON `CABINES` (`ID_TIPO_CABINE`);

CREATE INDEX `IX_CRUZEIROS_ID_NAVIO` ON `CRUZEIROS` (`ID_NAVIO`);

CREATE INDEX `IX_PESSOA_FAVORITOS_ID_CRUZEIRO` ON `PESSOA_FAVORITOS` (`ID_CRUZEIRO`);

CREATE INDEX `IX_PESSOA_FAVORITOS_ID_PESSOA` ON `PESSOA_FAVORITOS` (`ID_PESSOA`);

CREATE INDEX `IX_PESSOAS_ID_SEXO_PESSOA` ON `PESSOAS` (`ID_SEXO_PESSOA`);

CREATE INDEX `IX_TRIPULANTES_ID_CABINE_TRIPULANTE` ON `TRIPULANTES` (`ID_CABINE_TRIPULANTE`);

CREATE INDEX `IX_TRIPULANTES_ID_CRUZEIRO` ON `TRIPULANTES` (`ID_CRUZEIRO`);

CREATE INDEX `IX_TRIPULANTES_ID_PESSOA` ON `TRIPULANTES` (`ID_PESSOA`);

CREATE INDEX `IX_TRIPULANTES_ID_TIPO_TRIPULANTE` ON `TRIPULANTES` (`ID_TIPO_TRIPULANTE`);

ALTER TABLE `CABINE_TRIPULANTE` ADD CONSTRAINT `FK_CABINE_TRIPULANTE_TRIPULANTES_ID_TRIPULANTE` FOREIGN KEY (`ID_TRIPULANTE`) REFERENCES `TRIPULANTES` (`ID_TRIPULANTE`) ON DELETE CASCADE;

INSERT INTO `__EFMigrationsHistory` (`MigrationId`, `ProductVersion`)
VALUES ('20230504162327_Initial', '6.0.0');

COMMIT;

